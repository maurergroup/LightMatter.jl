<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1D Two-Temperature Model Simulation · LightMatter.jl</title><meta name="title" content="1D Two-Temperature Model Simulation · LightMatter.jl"/><meta property="og:title" content="1D Two-Temperature Model Simulation · LightMatter.jl"/><meta property="twitter:title" content="1D Two-Temperature Model Simulation · LightMatter.jl"/><meta name="description" content="Documentation for LightMatter.jl."/><meta property="og:description" content="Documentation for LightMatter.jl."/><meta property="twitter:description" content="Documentation for LightMatter.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LightMatter.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../gettingstarted/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../antennareactor/">Antenna Reactor Complex Simulation</a></li><li><a class="tocitem" href="../athem/">AthEM Simulation</a></li><li><a class="tocitem" href="../boltzmann/">Boltzmann Simulation</a></li><li><a class="tocitem" href="../dipoleapproximation/">Dipole Approximation Density Matrix Simulation</a></li><li><a class="tocitem" href="../surfaces/">Surface-Dependent Electronic Structure Simulation</a></li><li class="is-active"><a class="tocitem" href>1D Two-Temperature Model Simulation</a><ul class="internal"><li><a class="tocitem" href="#Theory-of-the-TTM"><span>Theory of the TTM</span></a></li></ul></li></ul></li><li><span class="tocitem">Systems</span><ul><li><a class="tocitem" href="../../Systems/athermalelectrons/">Athermal Electrons</a></li><li><a class="tocitem" href="../../Systems/densitymatrix/">Density Matrix</a></li><li><a class="tocitem" href="../../Systems/electronicdistribution/">Electronic Distribution</a></li><li><a class="tocitem" href="../../Systems/electronictemperature/">Electronic Temperature</a></li><li><a class="tocitem" href="../../Systems/lasers/">Lasers </a></li><li><a class="tocitem" href="../../Systems/phononicdistribution/">Phononic Distribution</a></li><li><a class="tocitem" href="../../Systems/phononictemperature/">Phonon Temperature</a></li><li><a class="tocitem" href="../../Systems/structure/">Structure</a></li></ul></li><li><a class="tocitem" href="../../outputting/">Post Processing</a></li><li><a class="tocitem" href="../../units/">Unit Management</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>1D Two-Temperature Model Simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>1D Two-Temperature Model Simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/maurergroup/LightMatter.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/maurergroup/LightMatter.jl/blob/main/docs/src/Tutorials/twotemperaturemodel.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ttm"><a class="docs-heading-anchor" href="#ttm">1D Two-Temperature Model Simulation</a><a id="ttm-1"></a><a class="docs-heading-anchor-permalink" href="#ttm" title="Permalink"></a></h1><p>In this tutorial we will discuss the theory of the Two-Temperature Model(TTM) as well as how to  perform a 1D TTM simulation. Due to the computational efficiency of the TTM, it is advised to perform a 1D simulation where possible as this is the more accurate option. The reason for no 2/3D simulations in LightMatter.jl is that the laser spot size is often much larger than the nanoscale that this package is designed to simulate so we can treat all points in this plane as equal. </p><h2 id="Theory-of-the-TTM"><a class="docs-heading-anchor" href="#Theory-of-the-TTM">Theory of the TTM</a><a id="Theory-of-the-TTM-1"></a><a class="docs-heading-anchor-permalink" href="#Theory-of-the-TTM" title="Permalink"></a></h2><p>The equations of motion for the 1D TTM are as follows:</p><p class="math-container">\[    C_\text{el}\frac{\partial T_\text{el}(z, t)}{\partial t} = \nabla(\kappa_\text{el}\nabla T_\text{el}) - g(T_\text{el} + T_\text{ph}) + S(t) \\
    C_\text{ph}\frac{\partial T_\text{ph}(z, t)}{\partial t} = \nabla(\kappa_\text{ph}\nabla T_\text{ph}) + g(T_\text{el} + T_\text{ph})\]</p><p>The aim of this method is to treat the two systems as thermal baths rather than electronic distributions. This has the advantage of reducing the computational complexity of propagating a distribution in k or E space into a simple scalar value. However, this takes the assumption that the systems are always in thermal equilibrium with themselves which isn&#39;t the case on the  short femtosecond time scale after excitation with a laser pulse. To model this non-equilbrium you need to extend your  level of theory to <a href="../athem/#athem">AthEM</a> or the <a href="../boltzmann/#boltzmann">Boltzmann equation</a>. </p><h3 id="Thermal-Baths"><a class="docs-heading-anchor" href="#Thermal-Baths">Thermal Baths</a><a id="Thermal-Baths-1"></a><a class="docs-heading-anchor-permalink" href="#Thermal-Baths" title="Permalink"></a></h3><p class="math-container">\[T_\text{el}\]</p><p>&amp; <span>$T_\text{ph}$</span> are the electronic and phononic thermal baths respectively. </p><h3 id="Heat-Capacities"><a class="docs-heading-anchor" href="#Heat-Capacities">Heat Capacities</a><a id="Heat-Capacities-1"></a><a class="docs-heading-anchor-permalink" href="#Heat-Capacities" title="Permalink"></a></h3><p class="math-container">\[C_\text{el}\]</p><p>&amp; <span>$C_\text{ph}$</span> are the heat capacities of the electronic and phononic systems. There is a couple of  approximations that can be used when modelling both of these in LightMatter.jl. For the electronic heat capacity, we have a constant (<code>:constant</code>), linear (<code>:linear</code>) and non-linear (<code>:nonlinear</code>) heat capacities, which increase in accuracy in that order. For a phonon heat capacity we have a constant (<code>:constant</code>) and non-linear (<code>:variable</code>) form only. The equations &amp; expressions for all these functions are given below. <em>Electronic Heat Capacities</em> <code>:constant</code> -&gt; <code>:(sim.electronictemperature.γ)</code> <code>:linear</code> -&gt; <code>:(sim.electronictemperature.γ * T_\text{el})</code> <code>:nonlinear</code> -&gt; <span>$\int\frac{\partial f(T\text_{el},μ,ϵ)}{\partial T} \text{DOS}(ϵ)ϵ dϵ$</span>              -&gt; <code>:(LightMatter.nonlinear_electronheatcapacity(Tel, μ, DOS))</code></p><p>Both the constant and linear approximations depend on the γ parameter within the electronic temperature whereas the non-linear approximation depends on a density-of-states (DOS) and the chemical potential (<span>$μ$</span>). To found out more about DOS in LightMatter.jl see the <a href="../athem/#athem">AthEM</a>. μ can be made temperature-dependent by setting <code>ChemicalPotential</code> to <code>true</code> within <code>Structure</code>. <em>Phononic Heat Capacities</em> <code>:constant</code> -&gt; <code>:(sim.phononictemperature.Cph)</code> <code>:variable</code> -&gt; <span>$9nk_B(\frac{Tph}{θ})^3 *\int\limits_0^{\theta_D} x^4 \frac{e^x}{(e^x-1)^2} dx$</span>              -&gt; <code>:(LightMatter.variable_phononheatcapacity(Tph, sim.phononictemperature.n, sim.phononictemperature.θ))</code> The constant approximation depends on the parameter <code>Cph</code> the user defines when constructing the phononic thermal bath. In the non-linear case, we use Simpson&#39;s rule to determine the heat capacity and this depends on the Debye temperature (<span>$θ$</span>) and the number of atoms per nm^3 (<span>$n$</span>). The Boltzmann constant is a constant within LightMatter.jl so is handled for you. To see more check out <a href="../../units/#units">Unit Handling</a>.</p><h3 id="Electron-Phonon-Coupling"><a class="docs-heading-anchor" href="#Electron-Phonon-Coupling">Electron-Phonon Coupling</a><a id="Electron-Phonon-Coupling-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-Phonon-Coupling" title="Permalink"></a></h3><p class="math-container">\[g\]</p><p>is the electorn-phonon coupling constant in the TTM. This parameter can be either a constant(<code>:constant</code>) provided  during construction or a non-linear parameter (<code>:variable</code>) calculated each time-step.  <code>:constant</code> -&gt; <code>:(sim.electronictemperature.g)</code> <code>:variable</code> -&gt; \frac{k<em>Bλω}{\text{DOS}(μ)ħ}\int \text{DOS}(ϵ)^2 \frac{\partial f(T</em>\text{el}, μ, ϵ)}{\partial E} dϵ             -&gt; <code>:(LightMatter.variable_electronphononcoupling(sim.electronictemperature.λ, sim.electronictemperature.ω, DOS, Tel, μ, Tph, sim.structure.egrid))</code></p><p>The new parameters in the <code>:variable</code> approximation are the electron-phonon mass enhancement factor (<span>$λ$</span>) and the second moment of the phonon spectrum (<span>$ω$</span>). To found out more check out [<a href="../../references/#lin2008">2</a>].</p><h3 id="Laser"><a class="docs-heading-anchor" href="#Laser">Laser</a><a id="Laser-1"></a><a class="docs-heading-anchor-permalink" href="#Laser" title="Permalink"></a></h3><p>The laser input is defined as S(t) in the equations at the top. It only directly interacts with the electronic system. To find out about the possible lasers see, <a href="../../Systems/lasers/#lasers">Lasers</a>.</p><h3 id="Thermal-Conductivity"><a class="docs-heading-anchor" href="#Thermal-Conductivity">Thermal Conductivity</a><a id="Thermal-Conductivity-1"></a><a class="docs-heading-anchor-permalink" href="#Thermal-Conductivity" title="Permalink"></a></h3><p>The thermal conductivity in LightMatter.jl is restricted to only the z-axis as currently 2/3D models are not possible. This means that <span>$\nabla$</span> represents <span>$\frac{\partial}{\partial z}$</span>. The gradients are calculated via finite difference, primarily central difference except at the edges. The thermal conductivity (<span>$κ$</span>) for electrons and phonons is treated differently. <em>Electrons</em> <span>$\kappa$</span> or <code>sim.electronictemperature.κ</code> represents the room temperature thermal conductivity of the electrons and  is scaled temperature dependetly during the simulation via <span>$κ_\text{final} = \kappa_\text{rt}\frac{T_\text{el}}{T_\text{ph}}$</span>. The phonon thermal conductivity however is treated as a constant. Currently there are no other options but in the future this may change. </p><p>##Example Simulation</p><p>Now that all the theory and approximations of the TTM have been discussed, at least in the context of LightMatter.jl, we will perform a couple of example simulations to show how to run a 1D simulation, the effect this has on temperatures compared to a 0D simulation, even at nanofilm thicknesses and also discuss the effect of the different approximations we can invoke. </p><div class="admonition is-info" id="Note-aefcbd4e65fe2f33"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-aefcbd4e65fe2f33" title="Permalink"></a></header><div class="admonition-body"><p>If you want to see a simple 0D Two-Temperature Model (TTM) then please check out <a href="../../gettingstarted/#getting-started">Getting Started</a>.</p></div></div><p>We  are going to use the highest level of approximation for this simulation of a 30nm gold film. Due to the computational  efficiency of the TTM there is no harm in performing the simulation at this level. In addition, heat capacities and electron -phonon couplings can be very temperature dependent and unless you know that your material is not in the temperature  window of your simulation it is best to calculate them explicitly. </p><p>First let&#39;s define everything we need outside of the thermal baths.</p><pre><code class="nohighlight hljs">    Dim = build_Dimension(collect(0.0:0.5:30.0))
    Struc = build_Structure(dimension=Dim, chemicalpotential = true, bulk_DOS=&quot;DOS/Au_DOS.dat&quot;, 
                            bulk_geometry = &quot;DOS/Au_geometry.in&quot;)
    Las = build_Laser(envelope=:Gaussian, FWHM=50.0u&quot;fs&quot;, ϕ=10.0u&quot;J/m^2&quot;, Transport=:optical, ϵ=16.3e-9u&quot;m&quot;)</code></pre><p>Here, we have defined a spatial grid to solve the problem on, this is done by giving a vector to <code>build_Dimension</code>. Next we have provided that struct to the <code>Structure</code> struct as well as defined that we want the chemical potential to update with repsect to the electronic temperature. We have also provided a location to find the DOS and a  geometry file that was used to calculate the DOS. Finally, we have built a very simple Gaussian laser, the same as the one used in <a href="../../gettingstarted/#getting-started">Getting Started</a>.</p><div class="admonition is-info" id="Note-51c2731f6326503a"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-51c2731f6326503a" title="Permalink"></a></header><div class="admonition-body"><p>All automatic implementations of DOS assembly (interpolation) assume that the DOS and geometry are in the FHI-AIMS format. There is an aim to make an automatic conversion in the future but if this is not the case then you can supply your own spline fit to the <code>DOS</code> KWARG in <code>build_Structure</code>. To ensure type stability use <span>$LightMatter.get_interpolant(energy, states)$</span> to create the spline and make sure that the units of your DOS are states/eVnm³.</p></div></div><p>Next let&#39;s build our thermal baths.</p><pre><code class="nohighlight hljs">    Tel = build_ElectronicTemperature(Enabled = true, Electron_PhononCoupling = true, Conductivity = true,
                                      ElectronicHeatCapcity = :nonlinear, ElectronPhononCouplingValue = :variable,
                                      κ = 278u&quot;J/s/m/K&quot;, λ = 0.18, ω = 13e-4u&quot;eV^2&quot;)
    Tph = build_PhononicTemperature(Enabled = true, Electron_PhononCoupling = true, Conductivity = true,
                                    PhononicHeatCapacity = :variable, κ = 2u&quot;J/s/m/K&quot;, θ = 162.3u&quot;K&quot;, n = 59.0u&quot;nm^-3&quot;)</code></pre><p>We can now go onto build our <code>Simulation</code> by bringing all this together.</p><pre><code class="nohighlight hljs">    Sim = build_Simulation(electronictemperature = Tel, phononictemperature = Tph, laser = Las, structure = Struc)</code></pre><p>And finally, after defining some initial conditions we can run the simulation</p><pre><code class="nohighlight hljs">    initialtemps=Dict(&quot;Tel&quot;=&gt;300.0,&quot;Tph&quot;=&gt;300.0)
    tspan=(-150.0, 1000.0)  
    sol = run_simulation(Sim, initialtemps, tspan, saveat=1.0, abstol=1e-10, reltol=1e-10)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../surfaces/">« Surface-Dependent Electronic Structure Simulation</a><a class="docs-footer-nextpage" href="../../Systems/athermalelectrons/">Athermal Electrons »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 1 August 2025 11:08">Friday 1 August 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
